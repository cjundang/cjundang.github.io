<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Web Layout A:B with PDF and Editor</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: row;
      font-family: sans-serif;
    }

    /* A:B = 70:30 */
    #A {
      width: 70%;
      display: flex;
      flex-direction: column;
      border-right: 2px solid #ddd;
    }
    #B {
      width: 30%;
      padding: 0;
      overflow: auto;
      background: #fafafa;
    }

    #A1 {
flex: 7;
border-bottom: 1px solid #ddd;
padding: 0;
}
#A2 {
flex: 3;
border-bottom: 1px solid #ddd;
padding: 0;
display: flex;
flex-direction: column;
}
#A2 {
display: flex;
flex-direction: column;
}

    textarea {
      width: 100%;
      height: 100%;
      resize: none;
      font-family: monospace;
      font-size: 14px;
      padding: 10px;
      box-sizing: border-box;
    }

    #runBtn {
      background: #2d6cdf;
      color: white;
      border: none;
      cursor: pointer;
    }
    #runBtn:hover {
      background: #1f4da8;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <div id="A">
    <!-- A1 PDF viewer -->
    <div id="A1" style="position:relative; overflow:auto;">
      <div id="pdfContainer" style="width:100%; height:100%; overflow:auto;
        display:flex; flex-direction:column; align-items:center; gap:20px;"></div>
    </div>

    <!-- A2 Editor -->
    <div id="A2">
      <div style="display:flex; gap:8px; padding:6px; border-bottom:1px solid #ccc;">
        <input type="file" id="pdfInput" accept="application/pdf" />
        <button id="loadPdfBtn">Load PDF</button>
        <button id="runBtn">รันโค้ด</button>
      </div>
      <textarea id="codeArea"></textarea>
    </div>
  </div>

  <!-- B Output -->
  <div id="B">
    <iframe id="output"></iframe>
  </div>

  <script>
    const runBtn = document.getElementById('runBtn');
    const codeArea = document.getElementById('codeArea');
    const output = document.getElementById('output');

    runBtn.addEventListener('click', () => {
      const code = codeArea.value;
      const doc = output.contentWindow.document;
      doc.open();
      doc.write(code);
      doc.close();
    });
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    const pdfjsLib = window['pdfjsLib'];

    document.getElementById('loadPdfBtn').addEventListener('click', () => {
      const file = document.getElementById('pdfInput').files[0];
      if (!file) return;

      const fileURL = URL.createObjectURL(file);
      const container = document.getElementById('pdfContainer');
      container.innerHTML = '';

      pdfjsLib.getDocument(fileURL).promise.then(pdf => {
        for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
          pdf.getPage(pageNum).then(page => {
            const containerHeight = container.clientHeight;
            const unscaledViewport = page.getViewport({ scale: 1 });
            const scale = containerHeight / unscaledViewport.height;
            const viewport = page.getViewport({ scale: scale });
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = viewport.width;
            canvas.height = viewport.height;

            container.appendChild(canvas);

            page.render({ canvasContext: ctx, viewport: viewport });
          });
        }
      });
    });
  </script>
</body>
</html>
